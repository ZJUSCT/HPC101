<font size=10>实验二：NumPy 向量化计算</font>

---

# 1 实验简介

[NumPy](https://numpy.org/) 是 Python 中科学计算的基础包。它是一个 Python 库，提供多维数组对象，各种派生对象（如掩码数组和矩阵），以及用于数组快速操作的各种 API，有包括数学、逻辑、形状操作、排序、选择、输入输出、离散傅立叶变换、基本线性代数，基本统计运算和随机模拟等等。

Numpy 代码一般采用向量化（矢量化）描述，这使得代码中没有任何显式的循环，索引等，这样的代码有以下好处：

- 向量化代码更简洁，更易于阅读
- 更少的代码行通常意味着更少的错误
- 代码更接近于标准的数学符号

另外，向量化的代码能够规避掉 Python 中缓慢的迭代循环，被底层的实现更好的调度，如接入 BLAS 矩阵运算库，从而实现更高的性能。

双线性插值是计算机视觉图像处理中的常用算法，它在计算机图形学中也可以用于材质贴图的重采样。

本次实验我们将借助 NumPy 实现一个支持批量处理的向量化的双线性插值，来让大家熟悉 NumPy 的向量化编程模式。

# 2 实验环境

- 任何支持 Python3 和 NumPy 的环境



# 3 实验基础知识介绍

## 3.0 NumPy API

由于课上已经介绍过这部分内容，因此我们在实验手册中略去。

## 3.1 双线性插值算法

双线性插值的算法其实非常简单，

## 3.2 NHWC 数据格式



# 4 实验步骤

## 4.1 接口定义

```python
def bilinear_interp(a: np.ndarray, b: np.ndarray) -> np.ndarray:
	# a is a ND array with shape [N, H1, W1, C]
	# b is a ND array with shape [N, H2, W2, 2]
	# return a ND array with shape [N, H2, W2, C]
```

其含义是，对于 batch 内的每一张 $$H1\times W1$$ 的图 a'，在 b' 中给出新的 $$H2\times W2$$ 的图中每个像素所想要采样的a' 图中对应点的坐标，并将采样结果返回



# 5 实验任务与要求

